{% extends "layout.html" %}
{% set _lang = lang or (i18n.lang if i18n is defined and i18n.lang else 'ko') %}
{% set _title = (seo.title if seo is seo is defined and seo.title else ('뉴스' if _lang='ko' else 'News')) %}
{% set _desc = (seo.description if seo is defined and seo.description else ('Pen Art 소식' if _lang=='ko' else 'Pen Art news')) %}

{% block head %}
    <title>{{ _title }}</title>
    <meta name="description" content="{{ _desc }}">
{% endblock %}

{% block content %}
    <header style="margin-bottom:12px">
        <h1 style="margin:0 0 6px 0;font-size:22px">{{ '뉴스' if _lang=='ko' else 'News' }}</h1>
        <p style="margin:0;color:#666;font-size:13px">{{ _desc }}</p>
    </header>

    <section style="display:flex;gap:10px;align-items:center;margin:12px 0">
        <input data-news-search type="search" placeholder="{{ '검색어 입력' if _lang=='ko' else 'Search' }}" style="flex:1;padding:8px 10px;border:1px solid #ddd;border-radius:6px">
        <span style="font-size:12px;color:#555">{{ '총' if _lang=='ko' else 'Total' }}: <strong data-news-total>{{ total if total is defined else 0 }}</strong></span>
    </section>

    <div data-news-root>
        <div data-news-list style="display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px">
            {% if ctx and ctx.items and ctx.items|length>0 %}
                {% for it in ctx.items %}
                    {% set _slug = it.slug or it.id %}
                    {% set _title_item = it.title %}
                    {% set _img = it.thumb or it.cover %}
                    <a href="/news/{{ _slug }}" data-news-items="{ it.id }" style="display:block;border:1px solid #eee;border-radius:10px;overflow:hidden;text-decoration:none;color:inherit;background:#fff">
                        {% if _img %}
                            <div style="height:160px;background:#f6f6f6;overflow:hidden">
                                <img src="{{ img|e }}" loading="lazy" alt="{{ (it.alt or _title_item or '')|e }}" width="640" height="480" style="width:100%;height:100%;object-fit:cover">
                            </div>
                        {% endif %}
                        <div style="padding:12px 12px 14px 12px">
                            <div style="font-size:12px;color:#888;margin-bottom:4px">
                                {% if it.published_at_kst %}{{ it.published_at_kst }}{% elif it.published_at %}{{ it.published_at }}{% else %}-{% endif %} (KST)
                            </div>
                            <h3 style="margin:0;font-size:16px;line-height:1.4">{{ _title_item }}</h3>
                            {% if it.excerpt or it.summary %}
                                <p style="margin:6px 0 0 0;color:#555;font-size:13px;line-height:1.5">{{ (it.excerpt or it.summary) }}</p>
                            {% endif %}
                        </div>
                    </a>
                {% endfor %}
            {% else %}
                <div data-news-empty style="padding:16px;text-align:center;color:#666">
                    {{ '아직 등록된 콘텐츠가 없습니다.' if _lang=='ko' else 'No news yet.' }}
                </div>
            {% endif %}
        </div>

        <div data-news-pager style="margin:16px 0"></div>
    </div>
{% endblock %}

{% block scripts %}
    <script src="/static/js/public_news.js" defer></script>
{% endblock %}
